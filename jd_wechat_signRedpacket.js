/*
京东微信签到红包

红包仅可在微信小程序使用
 
cron:29 4 * * * jd_wechat_signRedpacket.js

*/

const $ = new Env('京东微信签到红包')
var iｉl='jsjiami.com.v7';function iii1II(_0x423725,_0x4741f3){const _0x45377a=Iii11l();return iii1II=function(_0x1416e9,_0x5ec61c){_0x1416e9=_0x1416e9-0x157;let _0x1d076f=_0x45377a[_0x1416e9];if(iii1II['pPqMdX']===undefined){var _0x57df38=function(_0x5d15b8){const _0x255cfc='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1d8496='',_0x52efd4='';for(let _0x48850f=0x0,_0x2f90a5,_0x797c85,_0x4aeb62=0x0;_0x797c85=_0x5d15b8['charAt'](_0x4aeb62++);~_0x797c85&&(_0x2f90a5=_0x48850f%0x4?_0x2f90a5*0x40+_0x797c85:_0x797c85,_0x48850f++%0x4)?_0x1d8496+=String['fromCharCode'](0xff&_0x2f90a5>>(-0x2*_0x48850f&0x6)):0x0){_0x797c85=_0x255cfc['indexOf'](_0x797c85);}for(let _0x2f2327=0x0,_0x21e182=_0x1d8496['length'];_0x2f2327<_0x21e182;_0x2f2327++){_0x52efd4+='%'+('00'+_0x1d8496['charCodeAt'](_0x2f2327)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x52efd4);};const _0x4fa4e9=function(_0x3754e0,_0x1f8de5){let _0x5e3332=[],_0x1a4189=0x0,_0x2bdc70,_0x10a4eb='';_0x3754e0=_0x57df38(_0x3754e0);let _0x27824d;for(_0x27824d=0x0;_0x27824d<0x100;_0x27824d++){_0x5e3332[_0x27824d]=_0x27824d;}for(_0x27824d=0x0;_0x27824d<0x100;_0x27824d++){_0x1a4189=(_0x1a4189+_0x5e3332[_0x27824d]+_0x1f8de5['charCodeAt'](_0x27824d%_0x1f8de5['length']))%0x100,_0x2bdc70=_0x5e3332[_0x27824d],_0x5e3332[_0x27824d]=_0x5e3332[_0x1a4189],_0x5e3332[_0x1a4189]=_0x2bdc70;}_0x27824d=0x0,_0x1a4189=0x0;for(let _0x5b0424=0x0;_0x5b0424<_0x3754e0['length'];_0x5b0424++){_0x27824d=(_0x27824d+0x1)%0x100,_0x1a4189=(_0x1a4189+_0x5e3332[_0x27824d])%0x100,_0x2bdc70=_0x5e3332[_0x27824d],_0x5e3332[_0x27824d]=_0x5e3332[_0x1a4189],_0x5e3332[_0x1a4189]=_0x2bdc70,_0x10a4eb+=String['fromCharCode'](_0x3754e0['charCodeAt'](_0x5b0424)^_0x5e3332[(_0x5e3332[_0x27824d]+_0x5e3332[_0x1a4189])%0x100]);}return _0x10a4eb;};iii1II['ZbCDbb']=_0x4fa4e9,_0x423725=arguments,iii1II['pPqMdX']=!![];}const _0x3ab448=_0x45377a[0x0],_0x4a7f3b=_0x1416e9+_0x3ab448,_0xfe40f6=_0x423725[_0x4a7f3b];return!_0xfe40f6?(iii1II['VAWCml']===undefined&&(iii1II['VAWCml']=!![]),_0x1d076f=iii1II['ZbCDbb'](_0x1d076f,_0x5ec61c),_0x423725[_0x4a7f3b]=_0x1d076f):_0x1d076f=_0xfe40f6,_0x1d076f;},iii1II(_0x423725,_0x4741f3);}const llIll1=iii1II;(function(lI1Ili,IliilI,i1II1,iIIl11,l1l1I1,I1iIll,I1lliI){return lI1Ili=lI1Ili>>0x6,I1iIll='hs',I1lliI='hs',function(llIllI,I1ilI1,iillll,lIIilI,II1li1){const I1l1Il=iii1II;lIIilI='tfi',I1iIll=lIIilI+I1iIll,II1li1='up',I1lliI+=II1li1,I1iIll=iillll(I1iIll),I1lliI=iillll(I1lliI),iillll=0x0;const l1lIlI=llIllI();while(!![]&&--iIIl11+I1ilI1){try{lIIilI=parseInt(I1l1Il(0x195,'W8TL'))/0x1*(-parseInt(I1l1Il(0x16a,'5NU)'))/0x2)+-parseInt(I1l1Il(0x184,'%3Ub'))/0x3*(parseInt(I1l1Il(0x18c,'!HTr'))/0x4)+parseInt(I1l1Il(0x1d7,'7[B3'))/0x5+-parseInt(I1l1Il(0x1ad,'myzh'))/0x6+parseInt(I1l1Il(0x1ce,'y4vZ'))/0x7+parseInt(I1l1Il(0x1c1,'QAjC'))/0x8*(-parseInt(I1l1Il(0x1cf,'QqZX'))/0x9)+-parseInt(I1l1Il(0x188,'4@B^'))/0xa*(-parseInt(I1l1Il(0x194,'wUh5'))/0xb);}catch(IiiIl1){lIIilI=iillll;}finally{II1li1=l1lIlI[I1iIll]();if(lI1Ili<=iIIl11)iillll?l1l1I1?lIIilI=II1li1:l1l1I1=II1li1:iillll=II1li1;else{if(iillll==l1l1I1['replace'](/[wpWFQXdCLDNtrAgPIOSf=]/g,'')){if(lIIilI===I1ilI1){l1lIlI['un'+I1iIll](II1li1);break;}l1lIlI[I1lliI](II1li1);}}}}}(i1II1,IliilI,function(lIIil1,IIli1,II1liI,IlI1i1,l1lIl1,IiiIlI,Iilli1){return IIli1='\x73\x70\x6c\x69\x74',lIIil1=arguments[0x0],lIIil1=lIIil1[IIli1](''),II1liI=`\x72\x65\x76\x65\x72\x73\x65`,lIIil1=lIIil1[II1liI]('\x76'),IlI1i1=`\x6a\x6f\x69\x6e`,(0x16b7f7,lIIil1[IlI1i1](''));});}(0x2fc0,0xcbe63,Iii11l,0xc1),Iii11l)&&(iｉl=`\x24e`);const jdCookie=require(llIll1(0x185,'QAjC')),common=require(llIll1(0x1c7,'Z47k')),notify=require(llIll1(0x193,'I9aw'));function Iii11l(){const l1lIil=(function(){return[...[iｉl,'PQFjpAsjSffiamgit.dcwAoCgLm.NvDP7IXWdrOI==','dWStDh8','4PUUW7ROHBtLR6/KUApOV6/OOAZPLPBPM4VMLAFPLzxORAxNVBFPL7hORA4','W64LWQCMWP9Cs8kqWOtdL8oSnZ0WjSoHjLJcVXia','gsBdUmkWW6yLe3bdtSoeW5i5WO0YWOTVySkbaSk6zu0','lNJdHSkWeCoOfa','W5KtBCkgo8ovDG','oduMDG','W5VdP18','W6mYWQCJWRLC','WPTdlCom','pSoFWOXmW6ehu8k0WOGzBSk8vq','rW3dGCoeA8khW6SXscz0vWi','W6qBW4K','W7NcNmkoW6RdTq','8k6RRMa','WQVdHu1jW6zZlCo6iGmlWOZdNa','W4qyW4rrgq','iGtdNmkzEq','u2fR','l8kiWRldLSopWP8dyG02W5ldJ00','eCoKtW','bgtdIcHmu8kG','cIldPSkRDCkt','BUISREAZNowsUow6VH8','Bmo8jmoNeq','EmoEW6RcISkFW4zy','44oL5O+Y56w644k46k6N5ys36i2j5y6NyZ7dJN7dTwu','CILsDuZcQG','F8oFW7m','kwhdMmk4gCk5bCobA8oMdt7cN33dHumVW5ZdIsBdPmoSBWKNmmo8m8kpaLhcLmoZWPlcQHqykI7cKSo1W5iXWOxcR8komaBcR8o1W5VdL2hdMIRdTCkOt8oTvaNdNCkfWQCNESodwsGby8o+tuzeW47cLcxcTMaXW7BdLG3dImkwWRC0o0hcLmk7cSkLWOWlWOCYoNrvcKLEWO3dTfZcOCo2W77cHmozmSkcWQSUW55UxSkSWRdcM8oGumoNW5CbWP/cOSoZouNcRXdcH8ksyxNdRMBdM8oOW6qLWRKVW77dGt4mW50ntfNcRSo9WPjYW7NdMt5HWPDeWQ7cSaZcH28RWRNcKafvydX/DCopWQBcSM3cSJq6aW3dPSkuW5pcSw0BEfW8vHmznvtdG8kMWQWFWR3cOCkdWOf8ttJcPuTYW65Vy8kKW6xdQCkPaCosWQufFmkvDNVdIKZdLmoWW7xdSSkkCGbAW5tcV1ddGtameCkzp3PEW4TgW7iRxHldHgLGCSkTx8kRdmkBWOXwWOqRWQtcJSoQeqRdOSkbW7GIjgzzkh9RWR0iWQSuxxlcIL1ap8onc8oaWOZdG8kEW5FdI8kV','W6dcImk9W7tdPajWF8okdCkKW6tcVmk6W5LovSo8WRbvkhBdMtXTyL9KW7xdKq','6i6K5B2l57MR5y+ilq','WO0vCW','W6RcH3ebyq','D8kZWQFcQa','hb8w','WRZdICo4gSkImdyRWQG5mSoeWRG','4P+ZW5pMNklOGONMRBlNOB/LPAxNKAFcNW','gL7cM8ksl8oz','kxpdTXRcUSo2xW','WRDXW4DqvJxcTmkwgGe5WQhcKCoOW7PVpSkQxCkuWQi','AwOhW4i'],...(function(){return[...['WPhdPghcQSkK','pN/dHGns','W6Huf8k7FmkNWOD7d2FcMtZdJ8kjW4KZW4JcMCkwWOVdUgVdUCoDo8oxWOzjWRrglCoOWPRcP8o3lqepW7TUzGi2BCklW4tdPqhdLxBcOCkCW6veemovW6dcKqSDBsLOWRddNxNcJa1QWQ3dU8kVbCkdWR7dQSkFW7ldUt4nctKCAa3cG8oHW4NcJMNdLr7cLIRdUCoJj8kQWQZdPwBdT8oAWPFcLmoOW5L4W7jsl3KDdNVcVqBcUJddM8orpmoQg3mmW4ZdNfVcGmkOjmo1W4ddHLJcRI5VB8kiW5pdUCoDt8kPWQaBp8oYcJGzt1lcJCoXeSkvWPSns8o2','WOmZaCke','WQRcGmoZWOtcVCkKFG','hSkvW40H','csRdLSk4WRVdLtL6','yCkeWQJcJCos','44gO6lwX5y2/','W7JcICkvW6ldSWvoF8osj8kY','yGztseG','WPKIlCkBW4j0WOO4xSoQCCoPmSoydg7dNsypw8kzWO4DWRbzW51jW6WPWR7dM1O','ecRdKSkP','kIWU','W4FdOSkkfSkvW6v7','wwZdQmkGW50SdtbNtSoLW5G6WPueWOrct8kkcSkV','57M75yYr5lMN5y+B5zYS5B++5lY45Bo256MN5BUR5lYf55EM','nZuL','W7pcLSowWOtcQa','mt4DzepcImoNW41tWPWAW5CsW43cGGRdI8kuWO0foxTCWRv2W44eACoSarxcVSoh','EWT/W6e','ocrSsuRcMeS','W6uUWRq','WO3dGJHhjYrweCoOWPFcQZRdIG','hSkaiu5JW4SLWR8vsa','qmoAoei','zd1iuq','kSoOW7NcH3VcP8kxrCkM','WPRcMX/cSSkzhgFdSG5W','BUkDHSk+','WOuxhmk1W7e','rIldHSkHWQddHbG','nIZdVmo8WPi','imkpW5VcLgRdKSkHW6rAALqE','WQRdIK9iW6v9kSoteGihWOldNW','CWvSW4uyW7S','W6hcICkBW7a','w2BdQG','WQ5VWRC2WQrvvCoqWQddL8onpt4Oemo3cLJcVZ08cSogc8ohlJa','rINcMfSsamkeWP5NfG9t','W6CjrKyWubT8omom','5ywU5PIB4Ogv56Yz5yQj57I05y2p5y6y5A2p4OkP6k2O5BYM5zgo5lUN55kK772RccRPUi/KUj3cLq','rgddQSkQW4SOgsW','W5BdQmkvbCkzW7e'],...(function(){return['xSoMv8oZlW','W5jzWPrC','W6bRl8kryW','DXldOSkqW4xcN8k5W4JcMenJW4DBW7W5cSkVW7FcLvjZWRDvW4O','W4bxWP/cK30','W6more8','W5xcL1CdDhijamolWRJcGt3dJe3dTNlcR8klbCoLnCkjWPeTWONcKCkiWQJcNvm','xMFdRSkOW7OTbsW','hSoQxgzy','FSk5WRRcVNBcSmk2','WRfaWP53d2Gtr3C','WPNcNX/cNG','lwNdGCkL','yCkdW5S','dJ7dJmkK','uwddOCkWW6O7','WQzFhqS9EZr+','iCoTW7NdVIhdOSoKCmkZWR9zW47cPW','jhJcO8khhq','WQhdQY4','W4euDCkyzKNdJajzm8o0q8oV','esFdTCoWWRhdKmo+k0JdGfb8WOddLSoht8o1W4lcNxGE','WP9PdJSz','W73cImoYWP7cKG','yCk2W6uUWR4','WPtcKbJcMSkogW','ahddGX8','W4RcU1aNqG','W4qeW5TAoq','ywqu','ymkPWQRcRNlcPmkG','W5lcICkwW5ddPW','gcNdSSkRWOK','8lIPMfG','W4zmWR9nxIi','ksaLjeC7EfZdVW7dNXrPorPhA0ddIeXE','DhzWEcDRi1FdGsldRXfi','y1O7','4P2DWPFOH7pMNOJOVOVOOQNPGQFLIQ3KUP/PLjFOR71S','tK/dTG','cmoShMrNW4mE','WPSJe8kiW4jLWPe','W7/cOSow'];}())];}())];}());Iii11l=function(){return l1lIil;};return Iii11l();};let taskThreads=process[llIll1(0x183,'I9aw')]['jd_wechat_signRedpacket_threads']||'1';const runInterval=process[llIll1(0x15f,'7[B3')][llIll1(0x178,'J3&x')]||llIll1(0x19e,'W8TL'),isNotify=(process['env'][llIll1(0x19f,'%3Ub')]||process[llIll1(0x1be,'tAW[')][llIll1(0x161,'JSAr')])==='true',pinFilter=(process[llIll1(0x1ac,'U8(Q')][llIll1(0x180,'Hsu8')]||'')[llIll1(0x1d1,'JSAr')]('@');let cookiesArr=Object[llIll1(0x191,'JSAr')](jdCookie)[llIll1(0x1c3,'hJ&w')](li1II=>jdCookie[li1II])['filter'](IliI11=>IliI11);!cookiesArr[0x0]&&($[llIll1(0x1cb,'B[qQ')]($[llIll1(0x179,'!HTr')],llIll1(0x15d,'myzh')),process[llIll1(0x1a5,'stB(')](0x1));!(async()=>{const Illl1l=llIll1,i1ll={'bZoxj':function(i1l1lI){return i1l1lI();}};notify[Illl1l(0x198,'f[WY')]({'title':$[Illl1l(0x1cd,'myzh')]}),await i1ll[Illl1l(0x177,'K4&L')](Main),isNotify&&notify[Illl1l(0x189,'!7*@')]()&&await notify[Illl1l(0x1a7,'!HTr')]();})()[llIll1(0x1a1,'zZuJ')](i1iliI=>$[llIll1(0x190,'A5v@')](i1iliI))[llIll1(0x1c8,'stB(')](()=>$[llIll1(0x165,'4@B^')]());async function Main(){const Illl1i=llIll1,I1iIii={'Utyup':function(IllII1,I1iIil){return IllII1(I1iIil);},'ouSFA':function(lI1Iil,lilIiI){return lI1Iil>lilIiI;},'lZYZm':function(i1l1I,IiilIi){return i1l1I!==IiilIi;},'LpugZ':function(IiilIl,iii1Ii){return IiilIl(iii1Ii);},'JQjvM':function(iii1Il,lI1IiI){return iii1Il>=lI1IiI;},'SEVWN':Illl1i(0x1c5,'Ac%*'),'JesCn':Illl1i(0x17d,'T^xz'),'UNHsU':function(i1lI,IlI1l){return i1lI>IlI1l;},'TQQgY':Illl1i(0x18a,'Ac%*')};try{try{const i1l11=I1iIii[Illl1i(0x164,'%3Ub')](parseInt,taskThreads);I1iIii[Illl1i(0x199,'4BGr')](i1l11,0x0)&&I1iIii[Illl1i(0x1b1,'y4vZ')](i1l11,0x1)&&(taskThreads=i1l11);}catch{taskThreads=0x1;}taskThreads=Math[Illl1i(0x17a,'IGoO')](taskThreads,0xa),$[Illl1i(0x1a9,'W8TL')]=null;if(runInterval)try{const i1l1li=I1iIii[Illl1i(0x1b5,'pVyj')](parseInt,runInterval);I1iIii['JQjvM'](i1l1li,0x0)&&($['waitTime']=i1l1li);}catch{console[Illl1i(0x163,'[T$^')](I1iIii[Illl1i(0x19d,'KOdc')]);}console['log'](I1iIii['JesCn']),console[Illl1i(0x1a6,'y4vZ')](Illl1i(0x196,'tAW[')),$[Illl1i(0x1ae,'Tqdu')]=[],await common['concTask'](taskThreads,cookiesArr,taskFnc),$['runEnd']=![];I1iIii['UNHsU']($[Illl1i(0x16b,'T^xz')]['length'],0x0)&&(cookiesArr=cookiesArr[Illl1i(0x1a8,'Z47k')]((i1ilii,iIIII1)=>!$[Illl1i(0x1bc,'IGoO')][Illl1i(0x1a0,'Z47k')](iIIII1+0x1)),$['needRemoveCookieIndex']=[]);const lilIil=notify['getMessage']();lilIil&&(console['log']('\x0a📣\x20运行结果\x0a'+lilIil['replace'](/：/g,I1iIii[Illl1i(0x1c4,'Hsu8')])),isNotify&&await notify[Illl1i(0x170,'J3&x')]());}catch(i1l1ll){console['log'](Illl1i(0x1bf,'nsrL')+i1l1ll);}}async function taskFnc(I1iIiI,li1I1){const lIIiil=llIll1,i1ilil={'Inlhq':'SignComponent_doSignTask','NWzDp':function(I1lllI,ill111){return I1lllI===ill111;},'uHXSS':function(Iliil1,i1III){return Iliil1===i1III;},'Lljlz':lIIiil(0x172,'Ac%*'),'zSoVC':lIIiil(0x160,'stB('),'vQnYV':'https://servicewechat.com/wx91d27dbf599dff74/673/page-frame.html','RCVrF':lIIiil(0x16f,'p@^O'),'aUpNR':lIIiil(0x166,'Hsu8'),'ZSTwb':'Content-Type','vtaqu':function(Ii1iIi,iliIIl){return Ii1iIi<iliIIl;},'EPBCs':function(Ii1iIl,iliIIi,ill11I){return Ii1iIl(iliIIi,ill11I);},'fbMgf':function(Iliiil,li1Il){return Iliiil>=li1Il;},'Biitm':lIIiil(0x1bb,'xJ94'),'QUCLP':function(li1Ii,Iliiii){return li1Ii>Iliiii;},'jXaCO':function(i1illI,i1IIl){return i1illI(i1IIl);},'oKTTh':'已设置跳过运行当前账号','XetSf':function(I1lll1,i1IIi){return I1lll1===i1IIi;}};if($['runEnd'])return{'runEnd':!![]};const lilIii=decodeURIComponent(common['getCookieValue'](I1iIiI,i1ilil[lIIiil(0x16d,'TF(b')])),i1ill1=lIIiil(0x175,'dJQt')+li1I1+'】'+lilIii+'：',iIIl1l=notify[lIIiil(0x1cc,'I9aw')](li1I1,lilIii);if(i1ilil[lIIiil(0x174,'Tzq1')](pinFilter[lIIiil(0x169,'QqZX')],0x0)&&(pinFilter['includes'](lilIii)||pinFilter['includes'](i1ilil[lIIiil(0x15b,'AwpY')](encodeURIComponent,lilIii)))){iIIl1l[lIIiil(0x1c0,'WwJa')](i1ilil[lIIiil(0x1b0,'hJ&w')]),console[lIIiil(0x1d0,'pVyj')](iIIl1l['getInlineContent']()),$[lIIiil(0x17c,'Z47k')][lIIiil(0x186,'QAjC')](li1I1);return;}const llIli1=await common['getLoginStatus'](I1iIiI);if(!llIli1&&i1ilil[lIIiil(0x1b8,'JSAr')](typeof llIli1,lIIiil(0x15c,'7[B3'))){console[lIIiil(0x157,'zZuJ')](i1ill1+'账号无效'),$[lIIiil(0x1c6,'I9aw')]['push'](li1I1);return;}await iIIl1i(i1ilil[lIIiil(0x18d,'Tqdu')]);if($[lIIiil(0x15e,'K4&L')])return{'runEnd':!![]};if($[lIIiil(0x173,'!HTr')])await $[lIIiil(0x1b3,'wUh5')]($['waitTime']);async function iliIII(IIII1I,Iii111){const l1lIii=lIIiil;try{switch(IIII1I){case i1ilil[l1lIii(0x16e,'wUh5')]:if(i1ilil[l1lIii(0x1af,'W8TL')](Iii111[l1lIii(0x1ca,'Hsu8')],0x0)&&i1ilil[l1lIii(0x1b4,'%3Ub')](Iii111[l1lIii(0x158,'wUh5')],0x0))console['log'](i1ill1+'签到:'+Iii111['data'][l1lIii(0x197,'Z47k')]+'天,\x20获得红包:'+Iii111[l1lIii(0x1a4,'!7*@')]['rewardValue']+'元'),iIIl1l[l1lIii(0x1b2,'!7*@')](l1lIii(0x162,'4@B^')+Iii111[l1lIii(0x16c,'m5L)')][l1lIii(0x176,'JSAr')]+'元');else Iii111['message']?console[l1lIii(0x17e,'Hsu8')](i1ill1+'\x20'+Iii111[l1lIii(0x1a2,'4@B^')]):console[l1lIii(0x1b6,'m5L)')]('❓'+IIII1I+'\x20'+JSON['stringify'](Iii111));break;}}catch(l1l1II){console[l1lIii(0x1d6,'0*1E')](l1lIii(0x168,'%3Ub')+IIII1I+l1lIii(0x15a,'Ac%*')+(l1l1II['message']||l1l1II));}}async function iIIl1i(Iil1I1){const I11iI1=lIIiil;if($[I11iI1(0x159,'dJQt')])return;let Ii1iII='',l1i11I=null,II11II=null,Ii1iI1=i1ilil[I11iI1(0x1d4,'pVyj')];switch(Iil1I1){case I11iI1(0x19c,'Ch%b'):Ii1iII='https://api.m.jd.com/signTask/doSignTask',l1i11I=i1ilil['zSoVC'];break;default:console[I11iI1(0x192,'Z47k')]('❌\x20未知请求\x20'+Iil1I1);return;}const lilIli={'url':Ii1iII,'method':Ii1iI1,'headers':{'Cookie':I1iIiI,'Referer':i1ilil[I11iI1(0x18b,'J3&x')],'User-Agent':i1ilil[I11iI1(0x1ab,'QqZX')]},'params':II11II,'data':l1i11I,'timeout':0x7530};Ii1iI1===i1ilil[I11iI1(0x17f,'hJ&w')]&&(delete lilIli[I11iI1(0x181,'A5v@')],delete lilIli[I11iI1(0x1c2,'J3&x')][i1ilil[I11iI1(0x1d5,'dJQt')]]);const Iliili=0x1;let Iliill=0x0,IIII11=null,i1illi=![];while(i1ilil['vtaqu'](Iliill,Iliili)){const i1illl=await common[I11iI1(0x17b,'f[WY')](lilIli);if(!i1illl[I11iI1(0x1b7,'4@B^')]){IIII11=I11iI1(0x1ba,'GJJg')+Iil1I1+'\x20请求失败\x20➜\x20'+i1illl['error'],Iliill++;continue;}if(!i1illl[I11iI1(0x187,'K4&L')]){IIII11=I11iI1(0x1d2,'IGoO')+Iil1I1+'\x20请求失败\x20➜\x20无响应数据',Iliill++;continue;}await i1ilil[I11iI1(0x19b,'p@^O')](iliIII,Iil1I1,i1illl[I11iI1(0x19a,'xJ94')]),i1illi=![];break;}i1ilil[I11iI1(0x1b9,'!HTr')](Iliill,Iliili)&&(console['log'](IIII11),i1illi&&($['outFlag']=!![]));}}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){const {execSync} = require('child_process');execSync('sleep 15');return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){const {execSync} = require('child_process');execSync('sleep 15');if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
